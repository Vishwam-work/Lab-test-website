<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report analysis</title>



    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"
        integrity="sha512-t2JWqzirxOmR9MZKu+BMz0TNHe55G5BZ/tfTmXMlxpUY8tsTo3QMD27QGoYKZKFAraIPDhFv56HLdN11ctmiTQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer">

        </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js" type="text/javascript">

    </script>

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
</head>

<body>
    <p  id="demo1"></p>
    <p id="demo2"></p>
    <p id="demo3"></p>
    <p id="demo4"></p>
    <p id="demo5"></p>
    <div class="row">
    {% for i in sam %}
    <div class='col-md-6' style="font-size:20px;">
        <ul class="list-group">

            <li class="list-group-item  list-group-item-dark"><b>Sample id</b> : <input readonly id="samid" type="text"
                    class="form-control" name="samid" value="{{i.id}}"> </li>
            <li class="list-group-item  list-group-item-dark"><b>Sample Name</b> : <input readonly id="samname" type="text"
                    class="form-control" name="samname" value="{{i.sample_name}}"> </li>
            <li class="list-group-item  list-group-item-dark"><b>Sample Location</b> : <input readonly id="samloc" type="text"
                    class="form-control" name="samloc" value="{{i.sample_location}}"> </li>
            <li class="list-group-item  list-group-item-dark"><b>Sample System</b> : <input readonly id="samsystem" type="text"
                    class="form-control" name="samsystem" value="{{i.sample_system}}"> </li>
            <li class="list-group-item  list-group-item-dark"><b>Sample Sampling</b> : <input readonly id="samsampling" type="text"
                    class="form-control" name="samsampling" value="{{i.sample_sampling}}"> </li>
            <li class="list-group-item  list-group-item-dark"><b>Sample infected</b> : <input readonly id="saminfec" type="text"
                    class="form-control" name="saminfec" value="{{i.gridRadios}}"> </li>
            <li class="list-group-item  list-group-item-dark"><b>Sample Test1</b> : <input readonly id="samtest1" type="text"
                    class="form-control" name="samtest1" value="{{i.test1}}"> </li>
            <li class="list-group-item  list-group-item-dark"><b>Sample Test2</b> : <input readonly id="samtest2" type="text"
                    class="form-control" name="samloc" value="{{i.test2}}"> </li>

    </div>
   


    {% endfor %}
    
        <div class="col-md-6">


            Quantity
            <input id="pushvalue" type="number" class="form-control" name="num">
            Name
            <input id="pushlabel" type="text" class="form-control" name="name">
           

            <button id="push" class="btn btn-dark btn-submit w-100">Create</button>

            <button id="download" class="btn btn-dark btn-submit w-100 mt-2">Download Chart </button>
            <button id="downloadpdf" class="btn btn-dark btn-submit w-100 mt-2">Download Report</button>
            <canvas id="myChart" width="200" height="120"></canvas>
        </div>

        


            
       
    </div>
    <script>
        const ctx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: [],
                datasets: [{
                    label: 'contaminats',
                    data: [],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1,
                    showLine: true,
                    spanGaps: true
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        var  samid=document.getElementById("samid")
        var  samname=document.getElementById("samname")
        var  samloc=document.getElementById("samloc")
        var  samsystem=document.getElementById("samsystem")
        var  samsampling=document.getElementById("samsampling")
        var  saminfec=document.getElementById("saminfec")
        var  samtest1=document.getElementById("samtest1")
        var  samtest2=document.getElementById("samtest2")

        var demo = "Sample name :"
        var demo1 = "Sample location :"
        var demo2 = "Sample Test1 :"
        var demo3 = "Sample Test2 :"
        var demo4 = "Chart representation -"
        var demo5 = "Infected : "
        const pushlabel = document.getElementById("pushlabel");
        const hello = document.getElementById("hello");
        const pushvalue = document.getElementById("pushvalue");
        const push = document.getElementById("push");
        const download = document.getElementById('download');
        const downloadpdf = document.getElementById('downloadpdf');
        download.addEventListener('click', download_pic)
        downloadpdf.addEventListener('click', download_pdf)
        push.addEventListener('click', pushvaluechart);

        function download_pic() {
            const imagelink = document.createElement('a');
            const canvas = document.getElementById('myChart');
            imagelink.download = 'chart.png'
            imagelink.href = canvas.toDataURL('image/png', 1);
            // document.write('<img src=" '+imagelink+' "/>');

            console.log(imagelink)
            // window.open(imagelink)

            imagelink.click()

        };

        function download_pdf() {
            const canvas = document.getElementById('myChart');
            const canvaimg = canvas.toDataURL('image/png', 1.0);
            let pdf = new jsPDF("lanscape");
            pdf.setFontSize(20);

            pdf.text(samname.value,80,20)
            pdf.text(demo,20,20)
            pdf.text(demo1,20,30)
            pdf.text(demo2,20,40)
            pdf.text(demo3,20,50)
            pdf.text(demo4,20,70)
            pdf.text(demo5,20,60)
            pdf.text(samloc.value,80,30)
            pdf.text(samtest1.value,80,40)
            pdf.text(samtest2.value,80,50)
            pdf.text(saminfec.value,80,60)
            
            pdf.addImage(canvaimg, 'JPEG', 20, 80, 80, 100)
            pdf.save('report.pdf')

        }


        function pushvaluechart() {
            myChart.data.labels.push(pushlabel.value);

            console.log(myChart.data.datasets[0].data);

            myChart.data.datasets[0].data.push(pushvalue.value)
            // console.log(myChart.data.datasets[0].data.push(pushvalue.value));
            myChart.update()

        };

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>

</body>

</html>